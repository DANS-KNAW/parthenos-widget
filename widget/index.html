<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Data Policy - Demo</title>
        <meta name="viewport" content="width=device-width">

        <link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.0.2/css/bootstrap.min.css" />
        <link rel="stylesheet" href="assets/bower_components/bootstrap-vertical-tabs/bootstrap.vertical-tabs.css" />
	<link rel="stylesheet" href="http://code.jquery.com/qunit/qunit-1.14.0.css">
	<link rel="stylesheet" href="http://zandbak11.dans.knaw.nl/parthenos/widget.css">
	<script src="http://d3js.org/d3.v3.min.js"></script>
	<script src="/parthenos/settings.js"></script>
	<script src="https://code.jquery.com/jquery-1.10.2.js"></script>
    </head>
    <script>
	weburl = "http://zandbak11.dans.knaw.nl/widget";
	polurl = weburl + "/?policy=";
	contentsurl = weburl + '/contents';
	topicsurl = weburl + '/topics';
 	apiurl = "http://zandbak11.dans.knaw.nl/widget/?policy=ARHEO%20-%20Arheovest%20Association%20Timisoara";	
	apiurl = "http://zandbak11.dans.knaw.nl/widget/?policy=";
	apiurl = "http://zandbak11.dans.knaw.nl/widget/policies";
	apiurl_list = weburl + "/list";
    </script>
    <body>

        <div class="row" style="min-height:300px;">
  <div  class="col-sm-6">
    <h3>&nbsp;Data Policy Guide</h3>
    <hr/>
    <div class="col-xs-3"> <!-- required for floating -->
      <!-- Nav tabs -->
      <ul class="nav nav-tabs tabs-left">
        <li class="active"><a href="#target" data-toggle="tab">Community</a></li>
        <li><a href="#discripline" data-toggle="tab">Discipline</a></li>
        <li><a href="#fair" data-toggle="tab">Topic</a></li>
        <li><a href="#policy" data-toggle="tab">Policies</a></li>
      </ul>
    </div>

    <div class="col-xs-9">
      <!-- Tab panes -->
      <div class="tab-content">
        <div class="tab-pane active" id="target"><div style="float:left;"><h4>Select Community</h4></div>
    	    <div class="tab-pane active" style="float:right;" id="tab1">
            <a class="btn btn-primary btnNext" >Next</a>
            </div>
	    <br />
	</div>

<script>
d3.json(contentsurl, function(cdata) {
    var conthtml = '<br><ul id="nav-tabs-wrapper" class="nav nav-tabs nav-pills nav-stacked well">';
    topichtml = '<ul id="nav-tabs-wrapper" class="nav nav-tabs nav-pills nav-stacked well">';
    var tabnum = 0;
    for (k in cdata['contents']) {
	tabnum = tabnum + 1;
        var k_data = cdata['contents'][k];
	if (!k_data) {
	    if (tabnum == 1)
	    {
	        conthtml = conthtml + '<li class="active"><a href="#vtab1" data-toggle="tab">' + k + '</a></li>';
	    }
	    else
	    {
	        conthtml = conthtml + '<li><a href="#vtab' + tabnum + '" data-toggle="tab">' + k + '</a></li>';
	    }
	}
	else
	{
	    if (tabnum == 1)
            {
                conthtml = conthtml + '<li class="active"><a href="#vtab1" data-toggle="tab">' + k_data + '</a></li>';
		topichtml = topichtml + '<li class="active"><a href="#vtab' + tabnum + '" data-toggle="tab">' + k + '</a></li>';
            }
            else
            {
                conthtml = conthtml + '<li><a href="#vtab' + tabnum + '" data-toggle="tab">' + k_data + '</a></li>';
		topichtml = topichtml + '<li><a href="#vtab' + tabnum + '" data-toggle="tab">' + k + '</a></li>';
            }
	}
    }
    conthtml = conthtml + "</ul>"; 
    topichtml = topichtml + '</ul>';
    $('#target').append(conthtml);

    $(topichtml).appendTo('#discripline');
});
</script>

        <div class="tab-pane" id="discripline">
	    <div style="float:left;"><h4>Discripline</h4></div>
            <div class="tab-pane active" style="float:right;" id="tab">
            <a class="btn btn-primary btnNext" >Next</a>
	    </div>
	    <br />
	    <br />
	</div>

<script>
d3.json(topicsurl, function(cdata) {
    var tophtml = '<br><ul id="nav-tabs-wrapper" class="nav nav-tabs nav-pills nav-stacked well">';
    topichtml = '<br><p>Discipline</p><ul id="nav-tabs-wrapper" class="nav nav-tabs nav-pills nav-stacked well">';
    var tabnum = 0;
    for (k in cdata['topics']) {
        tabnum = tabnum + 1;
        var k_data = cdata['topics'][k];
	tophtml = tophtml + '<li><a href="#vtab' + tabnum + '" data-toggle="tab">' + k_data + '</a></li>';
	}

    tophtml = tophtml + '</ul>';
    $(tophtml).appendTo('#fair');
});
</script>

        <div class="tab-pane" id="fair"><div style="float:left;"><h4>FAIR Principles and Topics</h4></div>
            <div class="tab-pane active" style="float:right;" id="tab">
            <a class="btn btn-primary btnNext" >Next</a>
            </div>
	    <br />
	</div>
        <div class="tab-pane" id="policy"><div style="float:left;"><h4>Policies that match your selection</h4></div>
            <div class="tab-pane active" style="float:right;" id="tab">
            <a class="btn btn-primary btnNext" >Next</a>
            </div>
            <br />
        </div>
	
<script>
 $('.btnNext').click(function(){
  $('.nav-tabs > .active').next('li').find('a').trigger('click');
});

d3.json(apiurl, function(data) {
    console.log(data);
    var polhtml = '<br><ul id="nav-tabs-wrapper" class="nav nav-tabs nav-pills nav-stacked well">';
    for (k in data) {
        var k_data = data[k];
  	console.log(k_data);
  	for (d in k_data) {
		console.log(d, k_data[d]);
		var value = k_data[d];
		if (!value) {
			value = '';
		}
		name = "<a href='" + polurl + d + "'>" + d + "</a>";
		polhtml = polhtml + '<li><b>' + value + '</b>' + name + '</li>';
  	};
    };
  polhtml = polhtml + "</ul>";
  $(polhtml).appendTo('#policy');
});

</script>

        <div class="tab-pane" id="download">Download is coming...
	  <!--#exec cgi="/cgi-bin/test.cgi"-->
	</div>
      </div>
    </div>

    <div class="clearfix"></div>

  </div>

</div>


        <script src="http://code.jquery.com/jquery-1.10.2.min.js"></script>
        <script src="//netdna.bootstrapcdn.com/bootstrap/3.0.2/js/bootstrap.min.js"></script>
  	<script src="//cdn.jsdelivr.net/bootstrap.listgroup/1.1.2/listgroup.min.js"></script>
    </body>
</html>
